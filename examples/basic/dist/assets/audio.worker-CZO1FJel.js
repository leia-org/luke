(function(){"use strict";function h(e){const t=new Int16Array(e.length);for(let n=0;n<e.length;n++){const o=Math.max(-1,Math.min(1,e[n]));t[n]=o<0?o*32768:o*32767}return t}function g(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n]/(e[n]<0?32768:32767);return t}function f(e,t,n){if(t===n)return e;const o=t/n,c=Math.ceil(e.length/o),s=new Float32Array(c);for(let r=0;r<c;r++){const d=r*o,l=Math.floor(d),w=Math.min(l+1,e.length-1),i=d-l;s[r]=e[l]*(1-i)+e[w]*i}return s}function m(e){if(e.length===0)return 0;let t=0;for(let n=0;n<e.length;n++)t+=e[n]*e[n];return Math.sqrt(t/e.length)}let u=16e3,a=48e3;self.onmessage=e=>{const t=e.data;switch(t.type){case"configure":u=t.sampleRate,t.sourceSampleRate&&(a=t.sourceSampleRate);break;case"encode":p(t.samples);break;case"decode":M(t.pcmData);break}};function p(e){const t=f(e,a,u),n=m(t),o=h(t),c=new ArrayBuffer(o.byteLength);new Int16Array(c).set(o);const s={type:"encoded",pcmData:c,level:n};self.postMessage(s)}function M(e){const t=new Int16Array(e),n=g(t),o=f(n,24e3,a),c=new Float32Array(o.length);c.set(o);const s={type:"decoded",samples:c};self.postMessage(s)}})();
